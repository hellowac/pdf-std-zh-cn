# 12.8 数字签名

**12.8 Digital Signatures**

## 12.8.1 概述

**12.8.1 General**

=== "中文"

    A digital signature (PDF 1.3) may be used to authenticate the identity of a user and the document’s contents. It stores information about the signer and the state of the document when it was signed. The signature may be purely mathematical, such as a public/private-key encrypted document digest, or it may be a biometric form of identification, such as a handwritten signature, fingerprint, or retinal scan. The specific form of authentication used shall be implemented by a special software module called a signature handler. Signature handlers shall be identified in accordance with the rules defined in [Annex E](../a5.md).
    
    Digital signatures in ISO 32000 currently support two activities: adding a digital signature to a document and later checking that signature for validity. Revocation information is a signed attribute, which means that the signing software must capture the revocation information before signing. A similar requirement applies to the chain of certificates. The signing software must capture and validate the certificate's chain before signing.
    
    Signature information shall be contained in a signature dictionary, whose entries are listed in [Table 252](#table252). Signature handlers may use or omit those entries that are marked optional in the table but should use them in a standard way if they are used at all. In addition, signature handlers may add private entries of their own. To avoid name duplication, the keys for all such private entries shall be prefixed with the registered handler name followed by a PERIOD (2Eh).
    
    Signatures shall be created by computing a digest of the data (or part of the data) in a document, and storing the digest in the document. To verify the signature, the digest shall be re-computed and compared with the one stored in the document. Differences in the digest values indicate that modifications have been made since the document was signed.
    
    There are two defined techniques for computing a digital signature of the contents of all or part of a PDF file:
    
    - A byte range digest shall be computed over a range of bytes in the file, that shall be indicated by the **ByteRange** entry in the signature dictionary. This range should be the entire file, including the signature dictionary but excluding the signature value itself (the **Contents** entry). Other ranges may be used but since they do not check for all changes to the document, their use is not recommended. When a byte range digest is present, all values in the signature dictionary shall be direct objects.
    - Additionally, modification detection may be specified by a *signature reference dictionary*. The **TransformMethod** entry shall specify the general method for modification detection, and the **TransformParams** entry shall specify the variable portions of the method.
    
    A PDF document may contain the following standard types of signatures:
    
    - One or more approval signatures. These signatures appear in signature form fields (see [12.7.4.5], “Signature Fields”). The signature dictionary corresponding to each signature shall be the value of the form field (as specified by its V entry). The signature dictionary shall contain a **ByteRange** entry representing a byte range digest, as described previously. A signature shall be validated by recomputing the digest and comparing it with the one stored in the signature.
    
    !!! note "NOTE 1"
    
        If a signed document is modified and saved by incremental update (see [7.5.6], “Incremental Updates”), the data corresponding to the byte range of the original signature is preserved. Therefore, if the signature is valid, it is possible to recreate the state of the document as it existed at the time of signing.
    
    - At most one certification signature (PDF 1.5). The signature dictionary of a certification signature shall be the value of a signature field and shall contain a **ByteRange** entry. It may also be referenced from the **DocMDP** entry in the permissions dictionary (see [12.8.4], “Permissions”). The signature dictionary shall contain a signature reference dictionary (see [Table 253](#table253)) that has a **DocMDP** transform method. See [12.8.2.2], “DocMDP” for information on how these signatures shall be created and validated.
    
      A signature dictionary for a certification or approval signature may also have a signature reference dictionary with a **FieldMDP** transform method; see [12.8.2.4], “FieldMDP.”
    
    - At most two usage rights signatures (PDF 1.5). Its signature dictionary shall be referenced from the UR3 (PDF 1.6) entry in the permissions dictionary, whose entries are listed in [Table 258](#table258), (not from a signature field). The signature dictionary shall contain a **Reference** entry whose value is a signature reference dictionary that has a **UR** transform method. See [12.8.2.3], “UR” for information on how these signatures shall be created and validated.
    
                    
    <table id="table252" markdown="span">
        <caption>**Table 252 – Entries in a signature dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **Sig** for a signature dictionary.
                </td>
            </tr>
            <tr>
                <td>**Filter**</td>
                <td>name</td>
                <td>(Required; inheritable) The name of the preferred signature handler to use when validating this signature. If the **Prop_Build** entry is not present, it shall be also the name of the signature handler that was used to create the signature. If **Prop_Build** is present, it may be used to determine the name of the handler that created the signature (which is typically the same as **Filter** but is not needed to be). A conforming reader may substitute a different handler when verifying the signature, as long as it supports the specified **SubFilter** format. Example signature handlers are **Adobe.PPKLite**, **Entrust.PPKEF**, **CICI.SignIt**, and **VeriSign.PPKVS**. The name of the filter (i.e. signature handler) shall be identified in accordance with the rules defined in [Annex E](../a5.md).
                </td>
            </tr>
            <tr>
                <td>**SubFilter**</td>
                <td>name</td>
                <td>(Optional) A name that describes the encoding of the signature value and key information in the signature dictionary. A conforming reader may use any handler that supports this format to validate the signature. <br/>
                    (PDF 1.6) The following values for public-key cryptographic signatures shall be used: **adbe.x509.rsa_sha1**, **adbe.pkcs7.detached**, and **adbe.pkcs7.sha1** (see [12.8.3], “Signature Interoperability”). Other values may be defined by developers, and when used, shall be prefixed with the registered developer identification. All prefix names shall be registered (see [Annex E](../a5.md)). The prefix “adbe” has been registered by Adobe Systems and the three subfilter names listed above and defined in [12.8.3], “Signature Interoperability“ may be used by any developer.
                </td>
            </tr>
            <tr>
                <td>**Contents**</td>
                <td>byte string</td>
                <td>(Required) The signature value. When **ByteRange** is present, the value shall be a hexadecimal string (see [7.3.4.3], “Hexadecimal Strings”) representing the value of the byte range digest. <br/>
                    For public-key signatures, **Contents** should be either a DER-encoded PKCS#1 binary data object or a DER-encoded PKCS#7 binary data object. <br/>
                    Space for the Contents value must be allocated before the message digest is computed. (See [7.3.4], “String Objects“)
                </td>
            </tr>
            <tr>
                <td>**Cert**</td>
                <td>array or byte string</td>
                <td>(Required when **SubFilter** is **adbe.x509.rsa_sha1**) An array of byte strings that shall represent the X.509 certificate chain used when signing and verifying signatures that use public-key cryptography, or a byte string if the chain has only one entry. The signing certificate shall appear first in the array; it shall be used to verify the signature value in **Contents**, and the other certificates shall be used to verify the authenticity of the signing certificate. <br/>
                    If **SubFilter** is **adbe.pkcs7.detached** or **adbe.pkcs7.sha1**, this entry shall not be used, and the certificate chain shall be put in the PKCS#7 envelope in **Contents**.
                </td>
            </tr>
            <tr>
                <td>**ByteRange**</td>
                <td>array</td>
                <td>(Required for all signatures that are part of a signature field and usage rights signatures referenced from the **UR3** entry in the permissions dictionary) An array of pairs of integers (starting byte offset, length in bytes) that shall describe the exact byte range for the digest calculation. Multiple discontiguous byte ranges shall be used to describe a digest that does not include the signature value (the **Contents** entry) itself.
                </td>
            </tr>
            <tr>
                <td>**Reference**</td>
                <td>array</td>
                <td>(Optional; PDF 1.5) An array of signature reference dictionaries (see [Table 253](#table253)).
                </td>
            </tr>
            <tr>
                <td>**Changes**</td>
                <td>array</td>
                <td>(Optional) An array of three integers that shall specify changes to the document that have been made between the previous signature and this signature: in this order, the number of pages altered, the number of fields altered, and the number of fields filled in. <br/>
                    The ordering of signatures shall be determined by the value of **ByteRange**. Since each signature results in an incremental save, later signatures have a greater length value.
                </td>
            </tr>
            <tr>
                <td>**Name**</td>
                <td>text string</td>
                <td>(Optional) The name of the person or authority signing the document. This value should be used only when it is not possible to extract the name from the signature. <br/>
                    EXAMPLE 1 &emsp; From the certificate of the signer.
                </td>
            </tr>
            <tr>
                <td>**M**</td>
                <td>date</td>
                <td>(Optional) The time of signing. Depending on the signature handler, this may be a normal unverified computer time or a time generated in a verifiable way from a secure time server. <br/>
                    This value should be used only when the time of signing is not available in the signature. <br/>
                    EXAMPLE 2 &emsp; A time stamp can be embedded in a PKCS#7 binary data object (see [12.8.3.3], “PKCS#7 Signatures as used in ISO 32000”).
                </td>
            </tr>
            <tr>
                <td>**Location**</td>
                <td>text string</td>
                <td>(Optional) The CPU host name or physical location of the signing.
                </td>
            </tr>
            <tr>
                <td>**Reason**</td>
                <td>text string</td>
                <td>(Optional) The reason for the signing, such as ( I agree … ).
                </td>
            </tr>
            <tr>
                <td>**ContactInfo**</td>
                <td>text string</td>
                <td>(Optional) Information provided by the signer to enable a recipient to contact the signer to verify the signature. <br/>
                    EXAMPLE 3 &emsp; A phone number.
                </td>
            </tr>
            <tr>
                <td>**R**</td>
                <td>integer</td>
                <td>(Optional) The version of the signature handler that was used to create the signature. (PDF 1.5) This entry shall not be used, and the information shall be stored in the Prop_Build dictionary.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>integer</td>
                <td>(Optional; PDF 1.5) The version of the signature dictionary format. It corresponds to the usage of the signature dictionary in the context of the value of **SubFilter**. The value is 1 if the **Reference** dictionary shall be considered critical to the validation of the signature. <br/>
                    Default value: 0.
                </td>
            </tr>
            <tr>
                <td>**Prop_Build**</td>
                <td>dictionary</td>
                <td>(Optional; PDF 1.5) A dictionary that may be used by a signature handler to record information that captures the state of the computer environment used for signing, such as the name of the handler used to create the signature, software build date, version, and operating system. <br/>
                    he PDF Signature Build Dictionary Specification, provides implementation guidelines for the use of this dictionary.
                </td>
            </tr>
            <tr>
                <td>**Prop_AuthTime**</td>
                <td>integer</td>
                <td>(Optional; PDF 1.5) The number of seconds since the signer was last authenticated, used in claims of signature repudiation. It should be omitted if the value is unknown.
                </td>
            </tr>
            <tr>
                <td>**Prop_AuthType**</td>
                <td>name</td>
                <td>(Optional; PDF 1.5) The method that shall be used to authenticate the signer, used in claims of signature repudiation. Valid values shall be PIN, Password, and Fingerprint.
                </td>
            </tr>
        </tbody>
    </table>
    
    !!! note "NOTE 2"
    
        The entries in the signature dictionary can be conceptualized as being in different dictionaries; they are in one dictionary for historical and cryptographic reasons. The categories are signature properties (**R**, **M**, **Name**, **Reason**, **Location**, **Prop_Build**, **Prop_AuthTime**, and **Prop_AuthType**); key information (Cert and portions of **Contents** when the signature value is a PKCS#7 object); reference (Reference and ByteRange); and signature value (**Contents** when the signature value is a PKCS#1 object).
          
    <table id="table253" markdown="span">
        <caption>**Table 253 – Entries in a signature reference dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **SigRef** for a signature reference dictionary.
                </td>
            </tr>
            <tr>
                <td>**TransformMethod**</td>
                <td>name</td>
                <td>(Required) The name of the transform method (see Section [12.8.2], “Transform Methods”) that shall guide the modification analysis that takes place when the signature is validated. Valid values shall be: <br/>
                    **DocMDP** &emsp; Used to detect modifications to a document relative to a signature field that is signed by the originator of a document; see [12.8.2.2], “DocMDP.” <br/>
                    **UR** &emsp; Used to detect modifications to a document that would invalidate a signature in a rights-enabled document; see [12.8.2.3], “UR.” <br/>
                    **FieldMDP** &emsp; Used to detect modifications to a list of form fields specified in **TransformParams**; see [12.8.2.4], “FieldMDP.”
                </td>
            </tr>
            <tr>
                <td>**TransformParams**</td>
                <td>dictionary</td>
                <td>(Optional) A dictionary specifying transform parameters (variable data) for the transform method specified by **TransformMethod**. Each method takes its own set of parameters. See each of the sub-clauses specified previously for details on the individual transform parameter dictionaries
                </td>
            </tr>
            <tr>
                <td>**Data**</td>
                <td>(various)</td>
                <td>(Required when **TransformMethod** is **FieldMDP**) An indirect reference to the object in the document upon which the object modification analysis should be performed. For transform methods other than **FieldMDP**, this object is implicitly defined.
                </td>
            </tr>
            <tr>
                <td>**DigestMethod**</td>
                <td>name</td>
                <td>(Optional; PDF 1.5 required) A name identifying the algorithm that shall be used when computing the digest. Valid values are MD5 and SHA1. Default value: MD5. For security reasons, MD5 should not be used. It is mentioned for backwards compatibility, since it remains the default value.
                </td>
            </tr>
        </tbody>
    </table>

=== "英文"

    A digital signature (PDF 1.3) may be used to authenticate the identity of a user and the document’s contents. It stores information about the signer and the state of the document when it was signed. The signature may be purely mathematical, such as a public/private-key encrypted document digest, or it may be a biometric form of identification, such as a handwritten signature, fingerprint, or retinal scan. The specific form of authentication used shall be implemented by a special software module called a signature handler. Signature handlers shall be identified in accordance with the rules defined in [Annex E](../a5.md).
    
    Digital signatures in ISO 32000 currently support two activities: adding a digital signature to a document and later checking that signature for validity. Revocation information is a signed attribute, which means that the signing software must capture the revocation information before signing. A similar requirement applies to the chain of certificates. The signing software must capture and validate the certificate's chain before signing.
    
    Signature information shall be contained in a signature dictionary, whose entries are listed in [Table 252](#table252). Signature handlers may use or omit those entries that are marked optional in the table but should use them in a standard way if they are used at all. In addition, signature handlers may add private entries of their own. To avoid name duplication, the keys for all such private entries shall be prefixed with the registered handler name followed by a PERIOD (2Eh).
    
    Signatures shall be created by computing a digest of the data (or part of the data) in a document, and storing the digest in the document. To verify the signature, the digest shall be re-computed and compared with the one stored in the document. Differences in the digest values indicate that modifications have been made since the document was signed.
    
    There are two defined techniques for computing a digital signature of the contents of all or part of a PDF file:
    
    - A byte range digest shall be computed over a range of bytes in the file, that shall be indicated by the **ByteRange** entry in the signature dictionary. This range should be the entire file, including the signature dictionary but excluding the signature value itself (the **Contents** entry). Other ranges may be used but since they do not check for all changes to the document, their use is not recommended. When a byte range digest is present, all values in the signature dictionary shall be direct objects.
    - Additionally, modification detection may be specified by a *signature reference dictionary*. The **TransformMethod** entry shall specify the general method for modification detection, and the **TransformParams** entry shall specify the variable portions of the method.
    
    A PDF document may contain the following standard types of signatures:
    
    - One or more approval signatures. These signatures appear in signature form fields (see [12.7.4.5], “Signature Fields”). The signature dictionary corresponding to each signature shall be the value of the form field (as specified by its V entry). The signature dictionary shall contain a **ByteRange** entry representing a byte range digest, as described previously. A signature shall be validated by recomputing the digest and comparing it with the one stored in the signature.
    
    !!! note "NOTE 1"
    
        If a signed document is modified and saved by incremental update (see [7.5.6], “Incremental Updates”), the data corresponding to the byte range of the original signature is preserved. Therefore, if the signature is valid, it is possible to recreate the state of the document as it existed at the time of signing.
    
    - At most one certification signature (PDF 1.5). The signature dictionary of a certification signature shall be the value of a signature field and shall contain a **ByteRange** entry. It may also be referenced from the **DocMDP** entry in the permissions dictionary (see [12.8.4], “Permissions”). The signature dictionary shall contain a signature reference dictionary (see [Table 253](#table253)) that has a **DocMDP** transform method. See [12.8.2.2], “DocMDP” for information on how these signatures shall be created and validated.
    
      A signature dictionary for a certification or approval signature may also have a signature reference dictionary with a **FieldMDP** transform method; see [12.8.2.4], “FieldMDP.”
    
    - At most two usage rights signatures (PDF 1.5). Its signature dictionary shall be referenced from the UR3 (PDF 1.6) entry in the permissions dictionary, whose entries are listed in [Table 258](#table258), (not from a signature field). The signature dictionary shall contain a **Reference** entry whose value is a signature reference dictionary that has a **UR** transform method. See [12.8.2.3], “UR” for information on how these signatures shall be created and validated.
    
                    
    <table id="table252" markdown="span">
        <caption>**Table 252 – Entries in a signature dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **Sig** for a signature dictionary.
                </td>
            </tr>
            <tr>
                <td>**Filter**</td>
                <td>name</td>
                <td>(Required; inheritable) The name of the preferred signature handler to use when validating this signature. If the **Prop_Build** entry is not present, it shall be also the name of the signature handler that was used to create the signature. If **Prop_Build** is present, it may be used to determine the name of the handler that created the signature (which is typically the same as **Filter** but is not needed to be). A conforming reader may substitute a different handler when verifying the signature, as long as it supports the specified **SubFilter** format. Example signature handlers are **Adobe.PPKLite**, **Entrust.PPKEF**, **CICI.SignIt**, and **VeriSign.PPKVS**. The name of the filter (i.e. signature handler) shall be identified in accordance with the rules defined in [Annex E](../a5.md).
                </td>
            </tr>
            <tr>
                <td>**SubFilter**</td>
                <td>name</td>
                <td>(Optional) A name that describes the encoding of the signature value and key information in the signature dictionary. A conforming reader may use any handler that supports this format to validate the signature. <br/>
                    (PDF 1.6) The following values for public-key cryptographic signatures shall be used: **adbe.x509.rsa_sha1**, **adbe.pkcs7.detached**, and **adbe.pkcs7.sha1** (see [12.8.3], “Signature Interoperability”). Other values may be defined by developers, and when used, shall be prefixed with the registered developer identification. All prefix names shall be registered (see [Annex E](../a5.md)). The prefix “adbe” has been registered by Adobe Systems and the three subfilter names listed above and defined in [12.8.3], “Signature Interoperability“ may be used by any developer.
                </td>
            </tr>
            <tr>
                <td>**Contents**</td>
                <td>byte string</td>
                <td>(Required) The signature value. When **ByteRange** is present, the value shall be a hexadecimal string (see [7.3.4.3], “Hexadecimal Strings”) representing the value of the byte range digest. <br/>
                    For public-key signatures, **Contents** should be either a DER-encoded PKCS#1 binary data object or a DER-encoded PKCS#7 binary data object. <br/>
                    Space for the Contents value must be allocated before the message digest is computed. (See [7.3.4], “String Objects“)
                </td>
            </tr>
            <tr>
                <td>**Cert**</td>
                <td>array or byte string</td>
                <td>(Required when **SubFilter** is **adbe.x509.rsa_sha1**) An array of byte strings that shall represent the X.509 certificate chain used when signing and verifying signatures that use public-key cryptography, or a byte string if the chain has only one entry. The signing certificate shall appear first in the array; it shall be used to verify the signature value in **Contents**, and the other certificates shall be used to verify the authenticity of the signing certificate. <br/>
                    If **SubFilter** is **adbe.pkcs7.detached** or **adbe.pkcs7.sha1**, this entry shall not be used, and the certificate chain shall be put in the PKCS#7 envelope in **Contents**.
                </td>
            </tr>
            <tr>
                <td>**ByteRange**</td>
                <td>array</td>
                <td>(Required for all signatures that are part of a signature field and usage rights signatures referenced from the **UR3** entry in the permissions dictionary) An array of pairs of integers (starting byte offset, length in bytes) that shall describe the exact byte range for the digest calculation. Multiple discontiguous byte ranges shall be used to describe a digest that does not include the signature value (the **Contents** entry) itself.
                </td>
            </tr>
            <tr>
                <td>**Reference**</td>
                <td>array</td>
                <td>(Optional; PDF 1.5) An array of signature reference dictionaries (see [Table 253](#table253)).
                </td>
            </tr>
            <tr>
                <td>**Changes**</td>
                <td>array</td>
                <td>(Optional) An array of three integers that shall specify changes to the document that have been made between the previous signature and this signature: in this order, the number of pages altered, the number of fields altered, and the number of fields filled in. <br/>
                    The ordering of signatures shall be determined by the value of **ByteRange**. Since each signature results in an incremental save, later signatures have a greater length value.
                </td>
            </tr>
            <tr>
                <td>**Name**</td>
                <td>text string</td>
                <td>(Optional) The name of the person or authority signing the document. This value should be used only when it is not possible to extract the name from the signature. <br/>
                    EXAMPLE 1 &emsp; From the certificate of the signer.
                </td>
            </tr>
            <tr>
                <td>**M**</td>
                <td>date</td>
                <td>(Optional) The time of signing. Depending on the signature handler, this may be a normal unverified computer time or a time generated in a verifiable way from a secure time server. <br/>
                    This value should be used only when the time of signing is not available in the signature. <br/>
                    EXAMPLE 2 &emsp; A time stamp can be embedded in a PKCS#7 binary data object (see [12.8.3.3], “PKCS#7 Signatures as used in ISO 32000”).
                </td>
            </tr>
            <tr>
                <td>**Location**</td>
                <td>text string</td>
                <td>(Optional) The CPU host name or physical location of the signing.
                </td>
            </tr>
            <tr>
                <td>**Reason**</td>
                <td>text string</td>
                <td>(Optional) The reason for the signing, such as ( I agree … ).
                </td>
            </tr>
            <tr>
                <td>**ContactInfo**</td>
                <td>text string</td>
                <td>(Optional) Information provided by the signer to enable a recipient to contact the signer to verify the signature. <br/>
                    EXAMPLE 3 &emsp; A phone number.
                </td>
            </tr>
            <tr>
                <td>**R**</td>
                <td>integer</td>
                <td>(Optional) The version of the signature handler that was used to create the signature. (PDF 1.5) This entry shall not be used, and the information shall be stored in the Prop_Build dictionary.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>integer</td>
                <td>(Optional; PDF 1.5) The version of the signature dictionary format. It corresponds to the usage of the signature dictionary in the context of the value of **SubFilter**. The value is 1 if the **Reference** dictionary shall be considered critical to the validation of the signature. <br/>
                    Default value: 0.
                </td>
            </tr>
            <tr>
                <td>**Prop_Build**</td>
                <td>dictionary</td>
                <td>(Optional; PDF 1.5) A dictionary that may be used by a signature handler to record information that captures the state of the computer environment used for signing, such as the name of the handler used to create the signature, software build date, version, and operating system. <br/>
                    he PDF Signature Build Dictionary Specification, provides implementation guidelines for the use of this dictionary.
                </td>
            </tr>
            <tr>
                <td>**Prop_AuthTime**</td>
                <td>integer</td>
                <td>(Optional; PDF 1.5) The number of seconds since the signer was last authenticated, used in claims of signature repudiation. It should be omitted if the value is unknown.
                </td>
            </tr>
            <tr>
                <td>**Prop_AuthType**</td>
                <td>name</td>
                <td>(Optional; PDF 1.5) The method that shall be used to authenticate the signer, used in claims of signature repudiation. Valid values shall be PIN, Password, and Fingerprint.
                </td>
            </tr>
        </tbody>
    </table>
    
    !!! note "NOTE 2"
    
        The entries in the signature dictionary can be conceptualized as being in different dictionaries; they are in one dictionary for historical and cryptographic reasons. The categories are signature properties (**R**, **M**, **Name**, **Reason**, **Location**, **Prop_Build**, **Prop_AuthTime**, and **Prop_AuthType**); key information (Cert and portions of **Contents** when the signature value is a PKCS#7 object); reference (Reference and ByteRange); and signature value (**Contents** when the signature value is a PKCS#1 object).
          
    <table id="table252" markdown="span">
        <caption>**Table 252 – Entries in a signature dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **SigRef** for a signature reference dictionary.
                </td>
            </tr>
            <tr>
                <td>**TransformMethod**</td>
                <td>name</td>
                <td>(Required) The name of the transform method (see Section [12.8.2], “Transform Methods”) that shall guide the modification analysis that takes place when the signature is validated. Valid values shall be: <br/>
                    **DocMDP** &emsp; Used to detect modifications to a document relative to a signature field that is signed by the originator of a document; see [12.8.2.2], “DocMDP.” <br/>
                    **UR** &emsp; Used to detect modifications to a document that would invalidate a signature in a rights-enabled document; see [12.8.2.3], “UR.” <br/>
                    **FieldMDP** &emsp; Used to detect modifications to a list of form fields specified in **TransformParams**; see [12.8.2.4], “FieldMDP.”
                </td>
            </tr>
            <tr>
                <td>**TransformParams**</td>
                <td>dictionary</td>
                <td>(Optional) A dictionary specifying transform parameters (variable data) for the transform method specified by **TransformMethod**. Each method takes its own set of parameters. See each of the sub-clauses specified previously for details on the individual transform parameter dictionaries
                </td>
            </tr>
            <tr>
                <td>**Data**</td>
                <td>(various)</td>
                <td>(Required when **TransformMethod** is **FieldMDP**) An indirect reference to the object in the document upon which the object modification analysis should be performed. For transform methods other than **FieldMDP**, this object is implicitly defined.
                </td>
            </tr>
            <tr>
                <td>**DigestMethod**</td>
                <td>name</td>
                <td>(Optional; PDF 1.5 required) A name identifying the algorithm that shall be used when computing the digest. Valid values are MD5 and SHA1. Default value: MD5. For security reasons, MD5 should not be used. It is mentioned for backwards compatibility, since it remains the default value.
                </td>
            </tr>
        </tbody>
    </table>

## 12.8.2 变换方法

**12.8.2 Transform Methods**

### 12.8.2.1 概述

**12.8.2.1 General**

=== "中文"

    Transform methods, along with transform parameters, shall determine which objects are included and excluded in revision comparison. The following sub-clauses discuss the types of transform methods, their transform parameters, and when they shall be used.

=== "英文"

    Transform methods, along with transform parameters, shall determine which objects are included and excluded in revision comparison. The following sub-clauses discuss the types of transform methods, their transform parameters, and when they shall be used.

### 12.8.2.2 文档MDP

**12.8.2.2 DocMDP**

#### 12.8.2.2.1 概述

**12.8.2.2.1 General**

=== "中文"

    The **DocMDP** transform method shall be used to detect modifications relative to a signature field that is signed by the author of a document (the person applying the first signature). A document can contain only one signature field that contains a **DocMDP** transform method; it shall be the first signed field in the document. It enables the author to specify what changes shall be permitted to be made the document and what changes invalidate the author’s signature.
    
    !!! note "NOTE"
    
        As discussed earlier, “MDP” stands for *modification detection and prevention*. Certification signatures that use the DocMDP transform method enable detection of disallowed changes specified by the author. In addition, disallowed changes can also be prevented when the signature dictionary is referred to by the **DocMDP** entry in the permissions dictionary (see [12.8.4], “Permissions”).
    
    A certification signature should have a legal attestation dictionary (see [12.8.5], “Legal Content Attestations”) that specifies all content that might result in unexpected rendering of the document contents, along with the author’s attestation to such content. This dictionary may be used to establish an author’s intent if the integrity of the document is questioned.
    
    The **P** entry in the **DocMDP** transform parameters dictionary (see [Table 254](#table254)) shall indicate the author’s specification of which changes to the document will invalidate the signature. (These changes to the document shall also be prevented if the signature dictionary is referred from the **DocMDP** entry in the permissions dictionary.) A value of 1 for **P** indicates that the document shall be final; that is, any changes shall invalidate the signature. The values 2 and 3 shall permit modifications that are appropriate for form field or comment workflows.

=== "英文"

    The **DocMDP** transform method shall be used to detect modifications relative to a signature field that is signed by the author of a document (the person applying the first signature). A document can contain only one signature field that contains a **DocMDP** transform method; it shall be the first signed field in the document. It enables the author to specify what changes shall be permitted to be made the document and what changes invalidate the author’s signature.
    
    !!! note "NOTE"
    
        As discussed earlier, “MDP” stands for *modification detection and prevention*. Certification signatures that use the DocMDP transform method enable detection of disallowed changes specified by the author. In addition, disallowed changes can also be prevented when the signature dictionary is referred to by the **DocMDP** entry in the permissions dictionary (see [12.8.4], “Permissions”).
    
    A certification signature should have a legal attestation dictionary (see [12.8.5], “Legal Content Attestations”) that specifies all content that might result in unexpected rendering of the document contents, along with the author’s attestation to such content. This dictionary may be used to establish an author’s intent if the integrity of the document is questioned.
    
    The **P** entry in the **DocMDP** transform parameters dictionary (see [Table 254](#table254)) shall indicate the author’s specification of which changes to the document will invalidate the signature. (These changes to the document shall also be prevented if the signature dictionary is referred from the **DocMDP** entry in the permissions dictionary.) A value of 1 for **P** indicates that the document shall be final; that is, any changes shall invalidate the signature. The values 2 and 3 shall permit modifications that are appropriate for form field or comment workflows.

#### 12.8.2.2.2 验证使用 DocMDP 转换方法的签名

**12.8.2.2.2 Validating Signatures That Use the DocMDP Transform Method**

=== "中文"

    To validate a signature that uses the DocMDP transform method, a conforming reader first shall verify the byte range digest. Next, it shall verify that any modifications that have been made to the document are permitted by the transform parameters.
    
    Once the byte range digest is validated, the portion of the document specified by the **ByteRange** entry in the signature dictionary (see [Table 252](#table252)) is known to correspond to the state of the document at the time of signing.
    
    Therefore, conforming readers may compare the signed and current versions of the document to see whether
    there have been modifications to any objects that are not permitted by the transform parameters.
                    
    <table id="table254" markdown="span">
        <caption>**Table 254 – Entries in the DocMDP transform parameters dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **TransformParams** for a transform parameters dictionary.
                </td>
            </tr>
            <tr>
                <td>**P**</td>
                <td>number</td>
                <td>(Optional) The access permissions granted for this document. Valid values shall be: <br/>
                    1 &emsp; No changes to the document shall be permitted; any change to the document shall invalidate the signature. <br/>
                    2 &emsp;  Permitted changes shall be filling in forms, instantiating page templates, and signing; other changes shall invalidate the signature. <br/>
                    3 &emsp; Permitted changes shall be the same as for 2, as well as annotation creation, deletion, and modification; other changes shall invalidate the signature. <br/>
                    Default value: 2.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>name</td>
                <td>(Optional) The DocMDP transform parameters dictionary version. The only valid value shall be 1.2. <br/>
                NOTE    &emsp; this value is a name object, not a number. <br/>
                    Default value: 1.2.
                </td>
            </tr>
        </tbody>
    </table>

=== "英文"

    To validate a signature that uses the DocMDP transform method, a conforming reader first shall verify the byte range digest. Next, it shall verify that any modifications that have been made to the document are permitted by the transform parameters.
    
    Once the byte range digest is validated, the portion of the document specified by the **ByteRange** entry in the signature dictionary (see [Table 252](#table252)) is known to correspond to the state of the document at the time of signing.
    
    Therefore, conforming readers may compare the signed and current versions of the document to see whether
    there have been modifications to any objects that are not permitted by the transform parameters.
                    
    <table id="table254" markdown="span">
        <caption>**Table 254 – Entries in the DocMDP transform parameters dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **TransformParams** for a transform parameters dictionary.
                </td>
            </tr>
            <tr>
                <td>**P**</td>
                <td>number</td>
                <td>(Optional) The access permissions granted for this document. Valid values shall be: <br/>
                    1 &emsp; No changes to the document shall be permitted; any change to the document shall invalidate the signature. <br/>
                    2 &emsp;  Permitted changes shall be filling in forms, instantiating page templates, and signing; other changes shall invalidate the signature. <br/>
                    3 &emsp; Permitted changes shall be the same as for 2, as well as annotation creation, deletion, and modification; other changes shall invalidate the signature. <br/>
                    Default value: 2.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>name</td>
                <td>(Optional) The DocMDP transform parameters dictionary version. The only valid value shall be 1.2. <br/>
                NOTE    &emsp; this value is a name object, not a number. <br/>
                    Default value: 1.2.
                </td>
            </tr>
        </tbody>
    </table>

### 12.8.2.3 UR

**12.8.2.3 UR**

=== "中文"

    The **UR** transform method shall be used to detect changes to a document that shall invalidate a usage rights signature, which is referred to from the **UR3** entry in the permissions dictionary (see [12.8.4], “Permissions”). Usage rights signatures shall be used to enable additional interactive features that may not available by default in a conforming reader. The signature shall be used to validate that the permissions have been granted by a bonafide granting authority. The transform parameters dictionary (see [Table 255](#table255)) specifies the additional rights that shall be enabled if the signature is valid. If the signature is invalid because the document has been modified in a way that is not permitted or the identity of the signer is not granted the extended permissions, additional rights shall not be granted.
    
    !!! info "EXAMPLE"
    
        Adobe Systems grants permissions to enable additional features in Adobe Reader, using public-key cryptography. It uses certificate authorities to issue public key certificates to document creators with which it has entered into a business relationship. Adobe Reader verifies that the rights-enabling signature uses a certificate from an Adobe-authorized certificate authority. Other conforming readers are free to use this same mechanism for their own purposes.
    
    **UR3** (PDF 1.6): The **ByteRange** entry in the signature dictionary (see Table 252) shall be present. First, a conforming reader shall verify the byte range digest to determine whether the portion of the document specified by **ByteRange** corresponds to the state of the document at the time of signing. Next, a conforming reader shall examine the current version of the document to see whether there have been modifications to any objects that are not permitted by the transform parameters.
    
    <table id="table255" markdown="span">
        <caption>**Table 255 – Entries in the UR transform parameters dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be TransformParams for a transform parameters dictionary.
                </td>
            </tr>
            <tr>
                <td>**Document**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional document-wide usage rights for the document. The only defined value shall be FullSave, which permits a user to save the document along with modified form and/or annotation data. (PDF 1.5) Any usage right that permits the document to be modified implicitly shall enable the FullSave right. <br/> If the PDF document contains a **UR3** dictionary, only rights specified by the **Annots** entry that permit the document to be modified shall implicitly enable the FullSave right. For all other rights, FullSave shall be explicitly enabled in order to save the document. (Signature rights shall permit saving as part of the signing process but not otherwise). <br/>
                If the **P** entry in the **UR** transform parameters dictionary is **true** (PDF 1.6) and greater conforming readers shall permit only those rights that are enabled by the entries in the dictionary. However, conforming readers shall permit saving the document as long as any rights that permit modifying the document are enabled.
                </td>
            </tr>
            <tr>
                <td>**Msg**</td>
                <td>text string</td>
                <td>(Optional) A text string that may be used to specify any arbitrary information, such as the reason for adding usage rights to the document.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>name</td>
                <td>(Optional) The UR transform parameters dictionary version. The value shall be **2.2**. If an unknown version is present, no rights shall be enabled. <br/>
                    NOTE &emsp; This value is a name object, not a number. <br/>
                    Default value: **2.2**.
                </td>
            </tr>
            <tr>
                <td>**Annots**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional annotation-related usage rights for the document. Valid names (PDF 1.5) are Create, Delete, Modify, Copy, Import, and Export, which shall permit the user to perform the named operation on annotations. <br/>
                    The following names (PDF 1.6) shall be permitted only when the signature dictionary is referenced from the UR3 entry of the permissions dictionary (see [Table 258](#table258)): <br/>
                    Online &emsp; Permits online commenting; that is, the ability to upload or download markup annotations from a server. <br/>
                    SummaryView &emsp; Permits a user interface to be shown that summarizes the comments (markup annotations) in a document.
                </td>
            </tr>
            <tr>
                <td>**Form**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional form-field-related usage rights for the document. Valid names (PDF 1.5) are: <br/>
                    Add &emsp; Permits the user to add form fields to the document. <br/>
                    Delete &emsp; Permits the user to delete form fields to the document. <br/>
                    FillIn &emsp; Permits the user to save a document on which form fill-in has been done. <br/>
                    Import &emsp; Permits the user to import form data files in FDF, XFDF and text (CSV/TSV) formats. <br/>
                    Export &emsp; Permits the user to export form data files as FDF or XFDF. <br/>
                    SubmitStandalone Permits the user to submit form data when the document is not open in a Web browser.
                    SpawnTemplate &emsp; Permits new pages to be instantiated from named page templates. <br/>
                    The following names (PDF 1.6) shall be permitted only when the signature dictionary is referenced from the UR3 entry of the permissions dictionary; see [Table 258](#table258): <br/>
                    BarcodePlaintext Permits (PDF 1.6) text form field data to be encoded as a plaintext two-dimensional barcode. <br/>
                    Online &emsp; Permits (PDF 1.6) the use of forms-specific online mechanisms such as SOAP or Active Data Object.
                </td>
            </tr>
            <tr>
                <td>**Signature**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional signature-related usage rights for the document. The only defined value shall be Modify, which permits a user to apply a digital signature to an existing signature form field or clear a signed signature form field.
                </td>
            </tr>
            <tr>
                <td>**EF**</td>
                <td>array</td>
                <td>(Optional; PDF 1.6) An array of names specifying additional usage rights for named embedded files in the document. Valid names shall be Create, Delete, Modify, and Import, which shall permit the user to perform the named operation on named embedded files.
                </td>
            </tr>
            <tr>
                <td>**P**</td>
                <td>boolean</td>
                <td>(Optional; PDF 1.6) If **true**, permissions for the document shall be restricted in all consumer applications to those permissions granted by a conforming reader, while allowing permissions for rights enabled by other entries in this dictionary. Default value: **false**.
                </td>
            </tr>
        </tbody>
    </table>

=== "英文"

    The **UR** transform method shall be used to detect changes to a document that shall invalidate a usage rights signature, which is referred to from the **UR3** entry in the permissions dictionary (see [12.8.4], “Permissions”). Usage rights signatures shall be used to enable additional interactive features that may not available by default in a conforming reader. The signature shall be used to validate that the permissions have been granted by a bonafide granting authority. The transform parameters dictionary (see [Table 255](#table255)) specifies the additional rights that shall be enabled if the signature is valid. If the signature is invalid because the document has been modified in a way that is not permitted or the identity of the signer is not granted the extended permissions, additional rights shall not be granted.
    
    !!! info "EXAMPLE"
    
        Adobe Systems grants permissions to enable additional features in Adobe Reader, using public-key cryptography. It uses certificate authorities to issue public key certificates to document creators with which it has entered into a business relationship. Adobe Reader verifies that the rights-enabling signature uses a certificate from an Adobe-authorized certificate authority. Other conforming readers are free to use this same mechanism for their own purposes.
    
    **UR3** (PDF 1.6): The **ByteRange** entry in the signature dictionary (see Table 252) shall be present. First, a conforming reader shall verify the byte range digest to determine whether the portion of the document specified by **ByteRange** corresponds to the state of the document at the time of signing. Next, a conforming reader shall examine the current version of the document to see whether there have been modifications to any objects that are not permitted by the transform parameters.
    
    <table id="table255" markdown="span">
        <caption>**Table 255 – Entries in the UR transform parameters dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be TransformParams for a transform parameters dictionary.
                </td>
            </tr>
            <tr>
                <td>**Document**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional document-wide usage rights for the document. The only defined value shall be FullSave, which permits a user to save the document along with modified form and/or annotation data. (PDF 1.5) Any usage right that permits the document to be modified implicitly shall enable the FullSave right. <br/> If the PDF document contains a **UR3** dictionary, only rights specified by the **Annots** entry that permit the document to be modified shall implicitly enable the FullSave right. For all other rights, FullSave shall be explicitly enabled in order to save the document. (Signature rights shall permit saving as part of the signing process but not otherwise). <br/>
                If the **P** entry in the **UR** transform parameters dictionary is **true** (PDF 1.6) and greater conforming readers shall permit only those rights that are enabled by the entries in the dictionary. However, conforming readers shall permit saving the document as long as any rights that permit modifying the document are enabled.
                </td>
            </tr>
            <tr>
                <td>**Msg**</td>
                <td>text string</td>
                <td>(Optional) A text string that may be used to specify any arbitrary information, such as the reason for adding usage rights to the document.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>name</td>
                <td>(Optional) The UR transform parameters dictionary version. The value shall be **2.2**. If an unknown version is present, no rights shall be enabled. <br/>
                    NOTE &emsp; This value is a name object, not a number. <br/>
                    Default value: **2.2**.
                </td>
            </tr>
            <tr>
                <td>**Annots**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional annotation-related usage rights for the document. Valid names (PDF 1.5) are Create, Delete, Modify, Copy, Import, and Export, which shall permit the user to perform the named operation on annotations. <br/>
                    The following names (PDF 1.6) shall be permitted only when the signature dictionary is referenced from the UR3 entry of the permissions dictionary (see [Table 258](#table258)): <br/>
                    Online &emsp; Permits online commenting; that is, the ability to upload or download markup annotations from a server. <br/>
                    SummaryView &emsp; Permits a user interface to be shown that summarizes the comments (markup annotations) in a document.
                </td>
            </tr>
            <tr>
                <td>**Form**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional form-field-related usage rights for the document. Valid names (PDF 1.5) are: <br/>
                    Add &emsp; Permits the user to add form fields to the document. <br/>
                    Delete &emsp; Permits the user to delete form fields to the document. <br/>
                    FillIn &emsp; Permits the user to save a document on which form fill-in has been done. <br/>
                    Import &emsp; Permits the user to import form data files in FDF, XFDF and text (CSV/TSV) formats. <br/>
                    Export &emsp; Permits the user to export form data files as FDF or XFDF. <br/>
                    SubmitStandalone Permits the user to submit form data when the document is not open in a Web browser.
                    SpawnTemplate &emsp; Permits new pages to be instantiated from named page templates. <br/>
                    The following names (PDF 1.6) shall be permitted only when the signature dictionary is referenced from the UR3 entry of the permissions dictionary; see [Table 258](#table258): <br/>
                    BarcodePlaintext Permits (PDF 1.6) text form field data to be encoded as a plaintext two-dimensional barcode. <br/>
                    Online &emsp; Permits (PDF 1.6) the use of forms-specific online mechanisms such as SOAP or Active Data Object.
                </td>
            </tr>
            <tr>
                <td>**Signature**</td>
                <td>array</td>
                <td>(Optional) An array of names specifying additional signature-related usage rights for the document. The only defined value shall be Modify, which permits a user to apply a digital signature to an existing signature form field or clear a signed signature form field.
                </td>
            </tr>
            <tr>
                <td>**EF**</td>
                <td>array</td>
                <td>(Optional; PDF 1.6) An array of names specifying additional usage rights for named embedded files in the document. Valid names shall be Create, Delete, Modify, and Import, which shall permit the user to perform the named operation on named embedded files.
                </td>
            </tr>
            <tr>
                <td>**P**</td>
                <td>boolean</td>
                <td>(Optional; PDF 1.6) If **true**, permissions for the document shall be restricted in all consumer applications to those permissions granted by a conforming reader, while allowing permissions for rights enabled by other entries in this dictionary. Default value: **false**.
                </td>
            </tr>
        </tbody>
    </table>

### 12.8.2.4 FieldMDP

**12.8.2.4 FieldMDP**

=== "中文"

    The **FieldMDP** transform method shall be used to detect changes to the values of a list of form fields. The entries in its transform parameters dictionary are listed in Table 256.
                        
    <table id="table256" markdown="span">
        <caption>**Table 256 – Entries in the FieldMDP transform parameters dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **TransformParams** for a transform parameters dictionary.
                </td>
            </tr>
            <tr>
                <td>**Action**</td>
                <td>name</td>
                <td>(Required) A name that, along with the **Fields** array, describes which form fields do not permit changes after the signature is applied.<br/>
                    Valid values shall be:<br/>
                    All &emsp; All form fields. <br/>
                    Include &emsp; Only those form fields that specified in Fields. <br/>
                    Exclude &emsp; Only those form fields not specified in Fields. <br/>
                </td>
            </tr>
            <tr>
                <td>**Fields**</td>
                <td>array</td>
                <td>(Required if **Action** is Include or Exclude) An array of text strings containing field names.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>name</td>
                <td>(Optional: PDF 1.5 required) The transform parameters dictionary version. The value for PDF 1.5 and later shall be 1.2. <br/>
                    NOTE &emsp; This value is a name object, not a number. <br/>
                    Default value: 1.2.
                </td>
            </tr>
        </tbody>
    </table>
    
    On behalf of a document author creating a document containing both form fields and signatures the following shall be supported by conforming writers:
    
    - The author specifies that form fields shall be filled in without invalidating the approval or certification signature. The **P** entry of the **DocMDP** transform parameters dictionary shall be set to either 2 or 3 (see [Table 254](#table254)).
    - The author can also specify that after a specific recipient has signed the document, any modifications to specific form fields shall invalidate that recipient’s signature. There shall be a separate signature field for each designated recipient, each having an associated signature field lock dictionary (see Table 233) specifying the form fields that shall be locked for that user.
    - When the recipient signs the field, the signature, signature reference, and transform parameters
    dictionaries shall be created. The **Action** and **Fields** entries in the transform parameters dictionary shall
    be copied from the corresponding fields in the signature field lock dictionary.
    
    !!! note "NOTE"
    
        This copying is done because all objects in a signature dictionary must be direct objects if the dictionary contains a byte range signature. Therefore, the transform parameters dictionary cannot reference the signature field lock dictionary indirectly.
    
    **FieldMDP** signatures shall be validated in a similar manner to **DocMDP** signatures. See Validating Signatures That Use the DocMDP Transform Method in [12.8.2.2], “DocMDP” for details.

=== "英文"

    The **FieldMDP** transform method shall be used to detect changes to the values of a list of form fields. The entries in its transform parameters dictionary are listed in Table 256.
                        
    <table id="table256" markdown="span">
        <caption>**Table 256 – Entries in the FieldMDP transform parameters dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Type**</td>
                <td>name</td>
                <td>(Optional) The type of PDF object that this dictionary describes; if present, shall be **TransformParams** for a transform parameters dictionary.
                </td>
            </tr>
            <tr>
                <td>**Action**</td>
                <td>name</td>
                <td>(Required) A name that, along with the **Fields** array, describes which form fields do not permit changes after the signature is applied.<br/>
                    Valid values shall be:<br/>
                    All &emsp; All form fields. <br/>
                    Include &emsp; Only those form fields that specified in Fields. <br/>
                    Exclude &emsp; Only those form fields not specified in Fields. <br/>
                </td>
            </tr>
            <tr>
                <td>**Fields**</td>
                <td>array</td>
                <td>(Required if **Action** is Include or Exclude) An array of text strings containing field names.
                </td>
            </tr>
            <tr>
                <td>**V**</td>
                <td>name</td>
                <td>(Optional: PDF 1.5 required) The transform parameters dictionary version. The value for PDF 1.5 and later shall be 1.2. <br/>
                    NOTE &emsp; This value is a name object, not a number. <br/>
                    Default value: 1.2.
                </td>
            </tr>
        </tbody>
    </table>
    
    On behalf of a document author creating a document containing both form fields and signatures the following shall be supported by conforming writers:
    
    - The author specifies that form fields shall be filled in without invalidating the approval or certification signature. The **P** entry of the **DocMDP** transform parameters dictionary shall be set to either 2 or 3 (see [Table 254](#table254)).
    - The author can also specify that after a specific recipient has signed the document, any modifications to specific form fields shall invalidate that recipient’s signature. There shall be a separate signature field for each designated recipient, each having an associated signature field lock dictionary (see Table 233) specifying the form fields that shall be locked for that user.
    - When the recipient signs the field, the signature, signature reference, and transform parameters
    dictionaries shall be created. The **Action** and **Fields** entries in the transform parameters dictionary shall
    be copied from the corresponding fields in the signature field lock dictionary.
    
    !!! note "NOTE"
    
        This copying is done because all objects in a signature dictionary must be direct objects if the dictionary contains a byte range signature. Therefore, the transform parameters dictionary cannot reference the signature field lock dictionary indirectly.
    
    **FieldMDP** signatures shall be validated in a similar manner to **DocMDP** signatures. See Validating Signatures That Use the DocMDP Transform Method in [12.8.2.2], “DocMDP” for details.

## 12.8.3 签名互操作性

**12.8.3 Signature Interoperability**

### 12.8.3.1 概述

**12.8.3.1 General**

=== "中文"

    It is intended that conforming readers allow interoperability between signature handlers; that is, a PDF file signed with a handler from one vendor shall be able to be validated with a handler from a different vendor.
    
    If present, the **SubFilter** entry in the signature dictionary shall specify the encoding of the signature value and key information, while the **Filter** entry shall specify the preferred handler that should be used to validate the signature. When handlers are being registered according to Annex E they shall specify the SubFilter encodings they support enabling handlers other than the preferred handler to validate the signatures that the preferred handler creates.
    
    There are several defined values for the **SubFilter** entry, all based on public-key cryptographic standards published by RSA Security and also as part of the standards issued by the Internet Engineering Task Force (IETF) Public Key Infrastructure (PKIX) working group; see the Bibliography for references.

=== "英文"

    It is intended that conforming readers allow interoperability between signature handlers; that is, a PDF file signed with a handler from one vendor shall be able to be validated with a handler from a different vendor.
    
    If present, the **SubFilter** entry in the signature dictionary shall specify the encoding of the signature value and key information, while the **Filter** entry shall specify the preferred handler that should be used to validate the signature. When handlers are being registered according to Annex E they shall specify the SubFilter encodings they support enabling handlers other than the preferred handler to validate the signatures that the preferred handler creates.
    
    There are several defined values for the **SubFilter** entry, all based on public-key cryptographic standards published by RSA Security and also as part of the standards issued by the Internet Engineering Task Force (IETF) Public Key Infrastructure (PKIX) working group; see the Bibliography for references.

### 12.8.3.2 PKCS#1 签名

**12.8.3.2 PKCS#1 Signatures**

=== "中文"

    The PKCS#1 standard supports several public-key cryptographic algorithms and digest methods, including RSA encryption, DSA signatures, and SHA-1 and MD5 digests (see the Bibliography for references). For signing PDF files using PKCS#1, the only value of SubFilter that should be used is adbe.x509.rsa_sha1, which uses the RSA encryption algorithm and SHA-1 digest method. The certificate chain of the signer shall be stored in the **Cert** entry.

=== "英文"

    The PKCS#1 standard supports several public-key cryptographic algorithms and digest methods, including RSA encryption, DSA signatures, and SHA-1 and MD5 digests (see the Bibliography for references). For signing PDF files using PKCS#1, the only value of SubFilter that should be used is adbe.x509.rsa_sha1, which uses the RSA encryption algorithm and SHA-1 digest method. The certificate chain of the signer shall be stored in the **Cert** entry.

### 12.8.3.3 PKCS#7 ISO 32000 中使用的签名

**12.8.3.3 PKCS#7 Signatures as used in ISO 32000**

#### 12.8.3.3.1 概述

**12.8.3.3.1 General**

=== "中文"

    When PKCS#7 signatures are used, the value of **Contents** shall be a DER-encoded PKCS#7 binary data object containing the signature. The PKCS#7 object shall conform to RFC3852 Cryptographic Message Syntax. Different subfilters may be used and shall be registered in accordance with [Annex E](../a5.md). **SubFilter** shall take one of the following values:
    
    - **adbe.pkcs7.detached**: The original signed message digest over the document’s byte range shall be incorporated as the normal PKCS#7 SignedData field. No data shall be encapsulated in the PKCS#7 SignedData field.
    - **adbe.pkcs7.sha1**: The SHA1 digest of the document’s byte range shall be encapsulated in the PKCS#7 SignedData field with ContentInfo of type Data. The digest of that SignedData shall be incorporated as the normal PKCS#7 digest.
    
    The PKCS#7 object shall conform to the PKCS#7 specification in Internet RFC 2315, PKCS #7: Cryptographic Message Syntax, Version 1.5 (see the Bibliography). At minimum, it shall include the signer’s X.509 signing certificate. This certificate shall be used to verify the signature value in **Contents**.
    
    The PKCS#7 object should contain the following:
    
    - Time stamp information as an unsigned attribute (PDF 1.6): The timestamp token shall conform to RFC 3161 and shall be computed and embedded into the PKCS#7 object as described in Appendix A of RFC 3161. The specific treatment of timestamps and their processing is left to the particular signature handlers to define.
    - Revocation information as an signed attribute (PDF 1.6): This attribute may include all the revocation information that is necessary to carry out revocation checks for the signer's certificate and its issuer certificates. Since revocation information is a signed attribute, it must be obtained before the computation of the digital signature. This means that the software used by the signer must be able to construct the certification path and the associated revocation information. If one of the elements cannot be obtained (e.g. no connection is possible), a signature with this attribute will not be possible.
    - (PDF 1.6). This differs from the treatment when using adbe.x509.rsa_sha1 when the certificates shall be placed in the **Cert** key of the signature dictionary as defined in [Table 252](#table252).
    - One or more RFC 3281 attribute certificates associated with the signer certificate (PDF 1.7). The specific treatment of attribute certificates and their processing is left to the particular signature handlers to define.
    
    !!! note "NOTE"
    
        For maximum compatibility with earlier versions, conforming writers should follow this practice.
    
    The policy of how to establish trusted identity lists to validate embedded certificates is up to the validation signature handler.

=== "英文"

    When PKCS#7 signatures are used, the value of **Contents** shall be a DER-encoded PKCS#7 binary data object containing the signature. The PKCS#7 object shall conform to RFC3852 Cryptographic Message Syntax. Different subfilters may be used and shall be registered in accordance with [Annex E](../a5.md). **SubFilter** shall take one of the following values:
    
    - **adbe.pkcs7.detached**: The original signed message digest over the document’s byte range shall be incorporated as the normal PKCS#7 SignedData field. No data shall be encapsulated in the PKCS#7 SignedData field.
    - **adbe.pkcs7.sha1**: The SHA1 digest of the document’s byte range shall be encapsulated in the PKCS#7 SignedData field with ContentInfo of type Data. The digest of that SignedData shall be incorporated as the normal PKCS#7 digest.
    
    The PKCS#7 object shall conform to the PKCS#7 specification in Internet RFC 2315, PKCS #7: Cryptographic Message Syntax, Version 1.5 (see the Bibliography). At minimum, it shall include the signer’s X.509 signing certificate. This certificate shall be used to verify the signature value in **Contents**.
    
    The PKCS#7 object should contain the following:
    
    - Time stamp information as an unsigned attribute (PDF 1.6): The timestamp token shall conform to RFC 3161 and shall be computed and embedded into the PKCS#7 object as described in Appendix A of RFC 3161. The specific treatment of timestamps and their processing is left to the particular signature handlers to define.
    - Revocation information as an signed attribute (PDF 1.6): This attribute may include all the revocation information that is necessary to carry out revocation checks for the signer's certificate and its issuer certificates. Since revocation information is a signed attribute, it must be obtained before the computation of the digital signature. This means that the software used by the signer must be able to construct the certification path and the associated revocation information. If one of the elements cannot be obtained (e.g. no connection is possible), a signature with this attribute will not be possible.
    - (PDF 1.6). This differs from the treatment when using adbe.x509.rsa_sha1 when the certificates shall be placed in the **Cert** key of the signature dictionary as defined in [Table 252](#table252).
    - One or more RFC 3281 attribute certificates associated with the signer certificate (PDF 1.7). The specific treatment of attribute certificates and their processing is left to the particular signature handlers to define.
    
    !!! note "NOTE"
    
        For maximum compatibility with earlier versions, conforming writers should follow this practice.
    
    The policy of how to establish trusted identity lists to validate embedded certificates is up to the validation signature handler.

#### 12.8.3.3.2 吊销信息

**12.8.3.3.2 Revocation Information**

=== "中文"

    The adbe Revocation Information attribute:
    
    &emsp;&emsp;adbe-revocationInfoArchival OBJECT IDENTIFIER ::=
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;{ adbe(1.2.840.113583) acrobat(1) security(1) 8 }
    
    The value of the revocation information attribute can include any of the following data types:
    
    - Certificate Revocation Lists (CRLs), described in RFC 3280 (see the [Bibliography](../bibliography.md)): CRLs are generally large and therefore should not be embedded in the PKCS#7 object.
    - Online Certificate Status Protocol (OCSP) Responses, described in RFC 2560, X.509 Internet Public Key Infrastructure Online Certificate Status Protocol—OCSP (see the Bibliography): These are generally small and constant in size and should be the data type included in the PKCS#7 object.
    - Custom revocation information: The format is not prescribed by this specification, other than that it be encoded as an OCTET STRING. The application should be able to determine the type of data contained within the OCTET STRING by looking at the associated OBJECT IDENTIFIER.
    
    adbe's Revocation Information attribute value has ASN.1 type RevocationInfoArchival:
    
    ```text
    RevocationInfoArchival ::= SEQUENCE {
        crl          [0] EXPLICIT SEQUENCE of CRLs, OPTIONAL
        ocsp         [1] EXPLICIT SEQUENCE of OCSP Responses, OPTIONAL
        otherRevInfo [2] EXPLICIT SEQUENCE of OtherRevInfo, OPTIONAL
    }
    OtherRevInfo ::= SEQUENCE {
    Type OBJECT IDENTIFIER
    Value OCTET STRING
    }
    ```
    
    For byte range signatures, **Contents** shall be a hexadecimal string with “&lt;” and “&gt;” delimiters. It shall fit precisely in the space between the ranges specified by **ByteRange**. Since the length of PKCS#7 objects is not entirely predictable, the value of **Contents** shall be padded with zeros at the end of the string (before the “>” delimiter) before writing the PKCS#7 to the allocated space in the file.
    
    The format for encoding signature values should be **adbe.pkcs7.detached**. This encoding allows the most options in terms of algorithm use. The following table shows the algorithms supported for the various **SubFilter** values.
                            
    <table id="table257" markdown="span">
        <caption>**Table 257 – SubFilter value algorithm support**</caption>
        <thead>
            <tr>
                <th></th>
                <th colspan=3>**SubFilter value**</th>
            </tr>
            <tr>
                <th></th>
                <th>**adbe.pkcs7.detached**</th>
                <th>**adbe.pkcs7.sha1**</th>
                <th>**adbe.x509.rsa.sha1<sup>a</sup>**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Message Digest**</td>
                <td>SHA1 (PDF 1.3) <br/>
                    SHA256 (PDF 1.6) <br/>
                    SHA384 (PDF 1.7) <br/>
                    SHA512 (PDF 1.7) <br/>
                    RIPEMD160 (PDF 1.7)</td>
                <td>SHA1 (PDF 1.3)<sup>b</sup>
                </td>
                <td>SHA1 (PDF 1.3) <br/>
                    SHA256 (PDF 1.6) <br/>
                    SHA384 (PDF 1.7) <br/>
                    SHA512 (PDF 1.7) <br/>
                    RIPEMD160 (PDF 1.7)</td>
            </tr>
            <tr>
                <td>**RSA Algorithm Support**</td>
                <td>Up to 1024-bit (PDF 1.3)<br/>
                    Up to 2048-bit (PDF 1.5)<br/>
                    Up to 4096-bit (PDF 1.5)
                </td>
                <td>See <br/>
                    **adbe.pkcs7.detached**</td>
                <td>See <br/>
                    **adbe.pkcs7.detached**</td>
            </tr>
            <tr>
                <td>**DSA Algorithm Support**</td>
                <td>Up to 4096-bits (PDF 1.6)
                </td>
                <td>See <br/>
                    **adbe.pkcs7.detached**</td>
                <td>No</td>
            </tr>
            <tr>
                <td colspan=4><sup>a</sup> &emsp; Despite the appearance of **sha1** in the name of this **SubFilter** value, supported encodings shall not be limited to the SHA1 algorithm. The PKCS#1 object contains an identifier that indicates which al-gorithm shall be used.<br/>
                    <sup>b</sup> &emsp; Other digest algorithms may be used to digest the signed-data field; however, SHA1 shall be used to digest the data that is being signed.
                </td>
            </tr>
        </tbody>
    </table>

=== "英文"

    The adbe Revocation Information attribute:
    
    &emsp;&emsp;adbe-revocationInfoArchival OBJECT IDENTIFIER ::=
    &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;{ adbe(1.2.840.113583) acrobat(1) security(1) 8 }
    
    The value of the revocation information attribute can include any of the following data types:
    
    - Certificate Revocation Lists (CRLs), described in RFC 3280 (see the [Bibliography](../bibliography.md)): CRLs are generally large and therefore should not be embedded in the PKCS#7 object.
    - Online Certificate Status Protocol (OCSP) Responses, described in RFC 2560, X.509 Internet Public Key Infrastructure Online Certificate Status Protocol—OCSP (see the Bibliography): These are generally small and constant in size and should be the data type included in the PKCS#7 object.
    - Custom revocation information: The format is not prescribed by this specification, other than that it be encoded as an OCTET STRING. The application should be able to determine the type of data contained within the OCTET STRING by looking at the associated OBJECT IDENTIFIER.
    
    adbe's Revocation Information attribute value has ASN.1 type RevocationInfoArchival:
    
    ```text
    RevocationInfoArchival ::= SEQUENCE {
        crl          [0] EXPLICIT SEQUENCE of CRLs, OPTIONAL
        ocsp         [1] EXPLICIT SEQUENCE of OCSP Responses, OPTIONAL
        otherRevInfo [2] EXPLICIT SEQUENCE of OtherRevInfo, OPTIONAL
    }
    OtherRevInfo ::= SEQUENCE {
    Type OBJECT IDENTIFIER
    Value OCTET STRING
    }
    ```
    
    For byte range signatures, **Contents** shall be a hexadecimal string with “&lt;” and “&gt;” delimiters. It shall fit precisely in the space between the ranges specified by **ByteRange**. Since the length of PKCS#7 objects is not entirely predictable, the value of **Contents** shall be padded with zeros at the end of the string (before the “>” delimiter) before writing the PKCS#7 to the allocated space in the file.
    
    The format for encoding signature values should be **adbe.pkcs7.detached**. This encoding allows the most options in terms of algorithm use. The following table shows the algorithms supported for the various **SubFilter** values.
                            
    <table id="table257" markdown="span">
        <caption>**Table 257 – SubFilter value algorithm support**</caption>
        <thead>
            <tr>
                <th></th>
                <th colspan=3>**SubFilter value**</th>
            </tr>
            <tr>
                <th></th>
                <th>**adbe.pkcs7.detached**</th>
                <th>**adbe.pkcs7.sha1**</th>
                <th>**adbe.x509.rsa.sha1<sup>a</sup>**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Message Digest**</td>
                <td>SHA1 (PDF 1.3) <br/>
                    SHA256 (PDF 1.6) <br/>
                    SHA384 (PDF 1.7) <br/>
                    SHA512 (PDF 1.7) <br/>
                    RIPEMD160 (PDF 1.7)</td>
                <td>SHA1 (PDF 1.3)<sup>b</sup>
                </td>
                <td>SHA1 (PDF 1.3) <br/>
                    SHA256 (PDF 1.6) <br/>
                    SHA384 (PDF 1.7) <br/>
                    SHA512 (PDF 1.7) <br/>
                    RIPEMD160 (PDF 1.7)</td>
            </tr>
            <tr>
                <td>**RSA Algorithm Support**</td>
                <td>Up to 1024-bit (PDF 1.3)<br/>
                    Up to 2048-bit (PDF 1.5)<br/>
                    Up to 4096-bit (PDF 1.5)
                </td>
                <td>See <br/>
                    **adbe.pkcs7.detached**</td>
                <td>See <br/>
                    **adbe.pkcs7.detached**</td>
            </tr>
            <tr>
                <td>**DSA Algorithm Support**</td>
                <td>Up to 4096-bits (PDF 1.6)
                </td>
                <td>See <br/>
                    **adbe.pkcs7.detached**</td>
                <td>No</td>
            </tr>
            <tr>
                <td colspan=4><sup>a</sup> &emsp; Despite the appearance of **sha1** in the name of this **SubFilter** value, supported encodings shall not be limited to the SHA1 algorithm. The PKCS#1 object contains an identifier that indicates which al-gorithm shall be used.<br/>
                    <sup>b</sup> &emsp; Other digest algorithms may be used to digest the signed-data field; however, SHA1 shall be used to digest the data that is being signed.
                </td>
            </tr>
        </tbody>
    </table>

## 12.8.4 权限

**12.8.4 Permissions**

=== "中文"

    The **Perms** entry in the document catalogue (see [Table 28](../c7/s7.md#table28)) shall specify a *permissions dictionary* (PDF 1.5). Each entry in this dictionary (see Table 258 for the currently defined entries) shall specify the name of a permission handler that controls access permissions for the document. These permissions are similar to those defined by security handlers (see [Table 22](../c7/s6.md#table22)) but do not require that the document be encrypted. For a permission to be actually granted for a document, it shall be allowed by each permission handler that is present in the permissions dictionary as well as by the security handler. 
    
    !!! note "NOTE"
    
        An example of a permission is the ability to fill in a form field.
                            
    <table id="table258" markdown="span">
        <caption>**Table 258 – Entries in a permissions dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**DocMDP**</td>
                <td>dictionary</td>
                <td>(Optional) An indirect reference to a signature dictionary (see [Table 252](#table252)). This dictionary shall contain a **Reference** entry that shall be a signature reference dictionary (see [Table 252](#table252)) that has a **DocMDP** transform method (see [12.8.2.2], “DocMDP”) and corresponding transform parameters. <br/>
                    If this entry is present, consumer applications shall enforce the permissions specified by the **P** attribute in the **DocMDP** transform parameters dictionary and shall also validate the corresponding signature based on whether any of these permissions have been violated.
                </td>
            </tr>
            <tr>
                <td>**UR3**</td>
                <td>dictionary</td>
                <td>(Optional) A signature dictionary that shall be used to specify and validate additional capabilities (usage rights) granted for this document; that is, the enabling of interactive features of the conforming reader that are not available by default. <br/>
                    For example, A conforming reader does not permit saving documents by default, but an agent may grant permissions that enable saving specific documents. The signature shall be used to validate that the permissions have been granted by the agent that did the signing. <br/>
                    The signature dictionary shall contain a **Reference** entry that shall be a signature reference dictionary that has a **UR** transform method (see [12.8.2.3], “UR”). The transform parameter dictionary for this method indicates which additional permissions shall be granted for the document. If the signature is valid, the conforming reader shall allow the specified permissions for the document, in addition to the application’s default permissions.
                </td>
            </tr>
        </tbody>
    </table>

=== "英文"

    The **Perms** entry in the document catalogue (see [Table 28](../c7/s7.md#table28)) shall specify a *permissions dictionary* (PDF 1.5). Each entry in this dictionary (see Table 258 for the currently defined entries) shall specify the name of a permission handler that controls access permissions for the document. These permissions are similar to those defined by security handlers (see [Table 22](../c7/s6.md#table22)) but do not require that the document be encrypted. For a permission to be actually granted for a document, it shall be allowed by each permission handler that is present in the permissions dictionary as well as by the security handler. 
    
    !!! note "NOTE"
    
        An example of a permission is the ability to fill in a form field.
                            
    <table id="table258" markdown="span">
        <caption>**Table 258 – Entries in a permissions dictionary**</caption>
        <thead>
            <tr>
                <th>**Key**</th>
                <th>**Type**</th>
                <th>**Value**</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**DocMDP**</td>
                <td>dictionary</td>
                <td>(Optional) An indirect reference to a signature dictionary (see [Table 252](#table252)). This dictionary shall contain a **Reference** entry that shall be a signature reference dictionary (see [Table 252](#table252)) that has a **DocMDP** transform method (see [12.8.2.2], “DocMDP”) and corresponding transform parameters. <br/>
                    If this entry is present, consumer applications shall enforce the permissions specified by the **P** attribute in the **DocMDP** transform parameters dictionary and shall also validate the corresponding signature based on whether any of these permissions have been violated.
                </td>
            </tr>
            <tr>
                <td>**UR3**</td>
                <td>dictionary</td>
                <td>(Optional) A signature dictionary that shall be used to specify and validate additional capabilities (usage rights) granted for this document; that is, the enabling of interactive features of the conforming reader that are not available by default. <br/>
                    For example, A conforming reader does not permit saving documents by default, but an agent may grant permissions that enable saving specific documents. The signature shall be used to validate that the permissions have been granted by the agent that did the signing. <br/>
                    The signature dictionary shall contain a **Reference** entry that shall be a signature reference dictionary that has a **UR** transform method (see [12.8.2.3], “UR”). The transform parameter dictionary for this method indicates which additional permissions shall be granted for the document. If the signature is valid, the conforming reader shall allow the specified permissions for the document, in addition to the application’s default permissions.
                </td>
            </tr>
        </tbody>
    </table>

## 12.8.5 合法内容认证

**12.8.5 Legal Content Attestations**

=== "中文"

=== "英文"

The PDF language provides a number of capabilities that can make the rendered appearance of a PDF document vary. These capabilities could potentially be used to construct a document that misleads the recipient of a document, intentionally or unintentionally. These situations are relevant when considering the legal implications of a signed PDF document.

Therefore, a mechanism shall be provided by which a document recipient can determine whether the document can be trusted. The primary method is to accept only documents that contain certification signatures (one that has a **DocMDP** signature that defines what shall be permitted to change in a document; see [12.8.2.2], “DocMDP”).

When creating certification signatures, conforming writers should also create a legal attestation dictionary, whose entries are shown in Table 259. This dictionary shall be the value of the **Legal** entry in the document catalogue (see [Table 28](../c7/s7.md#table28)). Its entries shall specify all content that may result in unexpected rendering of the document contents. The author may provide further clarification of such content by means of the **Attestation** entry. Reviewers should establish for themselves that they trust the author and contents of the document. In the case of a legal challenge to the document, any questionable content can be reviewed in the context of the information in this dictionary.

<table id="table259" markdown="span">
    <caption>**Table 259 – Entries in a legal attestation dictionary**</caption>
    <thead>
        <tr>
            <th>**Key**</th>
            <th>**Type**</th>
            <th>**Value**</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>**JavaScriptActions**</td>
            <td>integer</td>
            <td>(Optional) The number of JavaScript actions found in the document (see [12.6.4.16], “JavaScript Actions”).</td>
        </tr>
        <tr>
            <td>**LaunchActions**</td>
            <td>integer</td>
            <td>(Optional) The number of launch actions found in the document (see [12.6.4.5], “Launch Actions”).</td>
        </tr>
        <tr>
            <td>**URIActions**</td>
            <td>integer</td>
            <td>(Optional) The number of URI actions found in the document (see , “URI Actions”).</td>
        </tr>
        <tr>
            <td>**MovieActions**</td>
            <td>integer</td>
            <td>(Optional) The number of movie actions found in the document (see [12.6.4.9], “Movie Actions”).</td>
        </tr>
        <tr>
            <td>**SoundActions**</td>
            <td>integer</td>
            <td>(Optional) The number of sound actions found in the document (see [12.6.4.8], “Sound Actions”).</td>
        </tr>
        <tr>
            <td>**HideAnnotationActions**</td>
            <td>integer</td>
            <td>(Optional) The number of hide actions found in the document (see [12.6.4.10], “Hide Actions”).</td>
        </tr>
        <tr>
            <td>**GoToRemoteActions**</td>
            <td>integer</td>
            <td>(Optional) The number of remote go-to actions found in the document (see [12.6.4.3], “Remote Go-To</td>
        </tr>
        Actions”).
        <tr>
            <td>**AlternateImages**</td>
            <td>integer</td>
            <td>(Optional) The number of alternate images found in the document (see [8.9.5.4], “Alternate Images”)</td>
        </tr>
        <tr>
            <td>**ExternalStreams**</td>
            <td>integer</td>
            <td>(Optional) The number of external streams found in the document.</td>
        </tr>
        <tr>
            <td>**TrueTypeFonts**</td>
            <td>integer</td>
            <td>(Optional) The number of TrueType fonts found in the document (see [9.6.3], “TrueType Fonts”).</td>
        </tr>
        <tr>
            <td>**ExternalRefXobjects**</td>
            <td>integer</td>
            <td>(Optional) The number of reference XObjects found in the document (see [8.10.4], “Reference XObjects”).</td>
        </tr>
        <tr>
            <td>**ExternalOPIdicts**</td>
            <td>integer</td>
            <td>(Optional) The number of OPI dictionaries found in the document (see [14.11.7], “Open Prepress Interface</td>
        </tr>
        (OPI)”).
        <tr>
            <td>**NonEmbeddedFonts**</td>
            <td>integer</td>
            <td>(Optional) The number of non-embedded fonts found in the document (see [9.9], “Embedded Font Programs””)</td>
        </tr>
        <tr>
            <td>**DevDepGS_OP**</td>
            <td>integer</td>
            <td>(Optional) The number of references to the graphics state parameter OP found in the document (see [Table 58](../c8/s4.md#table58)).</td>
        </tr>
        <tr>
            <td>**DevDepGS_HT**</td>
            <td>integer</td>
            <td>(Optional) The number of references to the graphics state parameter HT found in the document (see [Table 58](../c8/s4.md#table58)).</td>
        </tr>
        <tr>
            <td>**DevDepGS_TR**</td>
            <td>integer</td>
            <td>(Optional) The number of references to the graphics state parameter TR found in the document (see [Table 58](../c8/s4.md#table58)).</td>
        </tr>
        <tr>
            <td>**DevDepGS_UCR**</td>
            <td>integer</td>
            <td>(Optional) The number of references to the graphics state parameter UCR found in the document (see [Table 58](../c8/s4.md#table58)).</td>
        </tr>
        <tr>
            <td>**DevDepGS_BG**</td>
            <td>integer</td>
            <td>(Optional) The number of references to the graphics state parameter BG found in the document (see [Table 58](../c8/s4.md#table58)).</td>
        </tr>
        <tr>
            <td>**DevDepGS_FL**</td>
            <td>integer</td>
            <td>(Optional) The number of references to the graphics state parameter FL found in the document (see [Table 58](../c8/s4.md#table58)).</td>
        </tr>
        <tr>
            <td>**Annotations**</td>
            <td>integer</td>
            <td>(Optional) The number of annotations found in the document (see [12.5], “Annotations”).</td>
        </tr>
        <tr>
            <td>**OptionalContent**</td>
            <td>boolean</td>
            <td>(Optional) true if optional content is found in the document (see [8.11], “Optional Content”).</td>
        </tr>
        <tr>
            <td>**Attestation**</td>
            <td>text string</td>
            <td>(Optional) An attestation, created by the author of the document, explaining the presence of any of the other entries in this dictionary or the presence of any other content affecting the legal integrity of the document.</td>
        </tr>
    </tbody>
</table>

[8.11]: ../c8/s11.md
[9.9]: ../c9/s9.md
[12.5]: ../c12/s5.md

[7.3.4]: ../c7/s3.md#734-字符串对象
[7.5.6]: ../c7/s5.md#756-增量更新
[8.10.4]: ../c8/s10.md#8104-xobjects-引用
[9.6.3]: ../c9/s6.md#963-truetype-字体
[12.8.2]: ./s8.md#1282-变换方法
[12.8.3]: ./s8.md#1283-签名互操作性
[12.8.4]: #1284-权限
[14.11.7]: ../c14/s11.md#14117-开放印前接口-opi

[7.3.4.3]: ../c7/s3.md#7343-十六进制字符串
[8.9.5.4]: ../c8/s9.md#8954-替代图片
[12.6.4.3]: ../c12/s6.md#12643-远程操作
[12.6.4.5]: ../c12/s6.md#12645-启动操作
[12.6.4.7]: ../c12/s6.md#12647-uri-操作
[12.6.4.8]: ../c12/s6.md#12648-声音动作
[12.6.4.9]: ../c12/s6.md#12649-影片动作
[12.6.4.10]: ../c12/s6.md#126410-隐藏操作
[12.6.4.16]: ../c12/s6.md#126416-javascript-动作
[12.8.2.2]: #12822-文档mdp
[12.8.2.3]: #12823-ur
[12.8.2.4]: #12824-fieldmdp
[12.8.3.3]: #12833-pkcs7-iso-32000-中使用的签名
[12.7.4.5]: ./s7.md#12745-签名字段
